<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="A front-end template that helps you build fast, modern mobile web apps.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <title>BI Tool</title>

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <!-- <link rel="icon" sizes="192x192" href="images/android-desktop.png"> -->

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Material Design Lite">
    <!-- <link rel="apple-touch-icon-precomposed" href="images/ios-desktop.png"> -->

    <!-- Tile icon for Win8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="images/touch/ms-touch-icon-144x144-precomposed.png">
    <meta name="msapplication-TileColor" content="#3372DF">

    <!-- <link rel="shortcut icon" href="images/favicon.png"> -->


    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="./mdl/material.min.css">
    <link rel="stylesheet" href="styles.css">
      <!-- PLOTLY -->
      <script src="./plotly/plotly-latest.min.js"></script>
      <!-- JQUERY -->
        <script src="./jquery-3.3.1.min.js"></script>
       <!-- external libs from cdnjs -->

        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/4.1.2/papaparse.min.js"></script>

        <!-- PivotTable.js libs -->
        <link rel="stylesheet" type="text/css" href="./pivot/pivot.css">
        <script type="text/javascript" src="./pivot/pivot.js"></script>
        <script type="text/javascript" src="./pivot/pivot.jp.js"></script>
        <script type="text/javascript" src="./pivot/plotly_renderers.js"></script>
        <script type="text/javascript" src="./pivot/export_renderers.js"></script>
        <!-- Subtotal.js plugin libs -->
        <script type="text/javascript" src="./pivot/subtotal/subtotal.js"></script>
        <link rel="stylesheet" type="text/css" href="./pivot/subtotal/subtotal.css">

        <!-- FILE SAVE -->
        <script type="text/javascript" src="./FileSaver.min.js"></script>
        <script type="text/javascript" src="./Blob.js"></script>
  </head>
  <body>
    <div class="demo-layout mdl-layout mdl-js-layout mdl-layout--fixed-drawer mdl-layout--fixed-header">
      <header class="demo-header mdl-layout__header mdl-color--grey-100 mdl-color-text--grey-600">
        <div class="mdl-layout__header-row">
          <span class="mdl-layout-title">Pivot</span>
          <div class="mdl-layout-spacer"></div>
          <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" id="hdrbtn">
            <i class="material-icons">more_vert</i>
          </button>
          <ul class="mdl-menu mdl-js-menu mdl-js-ripple-effect mdl-menu--bottom-right" for="hdrbtn">
            <li class="mdl-menu__item">About</li>
            <li class="mdl-menu__item">Contact</li>
            <li class="mdl-menu__item">More products</li>
          </ul>
        </div>
      </header>
      <div class="demo-drawer mdl-layout__drawer mdl-color--blue-grey-900 mdl-color-text--blue-grey-50">
        <header class="demo-drawer-header">
          <i class="material-icons md-36">supervised_user_circle</i>
          <div class="demo-avatar-dropdown">
            <span>エム・アイ・エス</span>
            <div class="mdl-layout-spacer"></div>
            <button id="accbtn" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
              <i class="material-icons" role="presentation">arrow_drop_down</i>
              <span class="visuallyhidden">Accounts</span>
            </button>
            <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="accbtn">
              <li class="mdl-menu__item">Profile</li>
              <li class="mdl-menu__item">Logout</li>
            </ul>
          </div>
        </header>
        <nav class="demo-navigation mdl-navigation mdl-color--blue-grey-800">
          <a class="mdl-navigation__link" href="./index.html"><i class="mdl-color-text--blue-grey-400 material-icons" role="presentation">home</i>Home</a>
          <a class="mdl-navigation__link" href="./dashboard.html"><i class="mdl-color-text--blue-grey-400 material-icons" role="presentation">insert_chart_outlined</i>Dashboard</a>
          <a class="mdl-navigation__link" href="./pivot.html"><i class="mdl-color-text--blue-grey-400 material-icons" role="presentation">web</i>Pivot table</a>
          <div class="mdl-layout-spacer"></div>
          <a class="mdl-navigation__link" href=""><i class="mdl-color-text--blue-grey-400 material-icons" role="presentation">help_outline</i><span class="visuallyhidden">Help</span></a>
        </nav>
      </div>
      <main class="mdl-layout__content mdl-color--grey-100">
        <div class="bi-grid mdl-grid demo-content">
               <div class="mdl-color--white mdl-shadow--2dp mdl-cell mdl-cell--12-col mdl-grid " style="min-height: 250px">
                <div class="mdl-cell mdl-cell--6-col">
                  <h5>Data upload</h5>
                    <p align="center" style="line-height: 1.5">
                        Drop a CSV file on this page or
                        <label id="filechooser">click here to choose one<input id="csv" type="file" style="display:none"/></label>
                        <br /><br />
                        <textarea placeholder="or drag a CSV file here" style="width: 300px;" id="textarea" disabled></textarea>
                    </p>
                </div>
                <div class="mdl-cell mdl-cell--6-col">
                   <h5>Setting</h5>
                   <button class="mdl-button mdl-js-button mdl-button--raised" onclick="tableToExcel('pivot-table', 'W3C Example Table')"> Export Excel </button>
                </div>
               </div>
               <div class="bi-pivot mdl-color--white mdl-shadow--2dp mdl-cell mdl-cell--12-col mdl-grid " style="min-height: 550px">
                    <div id="output" style="margin: 10px;"></div>

               </div>
        </div>
      </main>
    </div>
      
      
       <a href="./dataquery.html" id="add-btn" class="float-btn bi-button--background-color mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect">
       		<i class="material-icons" >add</i>
       </a>
       <div class="mdl-tooltip mdl-tooltip--top " for="add-btn">
					Add new data set
	  </div>
    <script src="./mdl/material.min.js"></script>
    <script src="./pivot.js"></script>
    <script>
      function SaveAsFile(t,f,m) {
            try {
                var b = new Blob([t],{type:m});
                saveAs(b, f);
            } catch (e) {
                window.open("data:"+m+"," + encodeURIComponent(t), '_blank','');
            }
        }


      // SaveAsFile("1,2,3","filename.pdf","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64");

        
      var tableToExcel = (function() {            
          var uri = 'data:application/vnd.ms-excel;base64,'
            , template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--><meta http-equiv="content-type" content="text/plain; charset=UTF-8"/></head><body><table>{table}</table></body></html>'
            , base64 = function(s) { return window.btoa(unescape(encodeURIComponent(s))) }
            , format = function(s, c) { return s.replace(/{(\w+)}/g, function(m, p) { return c[p]; }) }
          return function(table, name) {
            if (!table.nodeType) table = document.getElementById(table)
            var ctx = {worksheet: name || 'Worksheet', table: table.innerHTML}
            window.location.href = uri + base64(format(template, ctx))
          }
        })()

</script>
  </body>
</html>
